<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manejo de interrupciones</title>
    <link rel="shortcut icon" href="..\Imagenes\Universidad-de-carabobo.png" />
    <!-- fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&family=Roboto&display=swap"
      rel="stylesheet"
    />
    <!-- CSS file -->
    <link rel="stylesheet" href="..\css\prueba.css" />
    <link rel="stylesheet" href="..\css\media-screen.css" />
    <link rel="stylesheet" href="..\css\descripcion-de-las-librerias.css" />
    <link rel="stylesheet" href="..\css\Manejo-de-la-pantalla-LCD.css" />
    <link
      rel="stylesheet"
      href="https://pro.fontawesome.com/releases/v5.10.1/css/all.css"
    />
    <link rel="stylesheet" href="..\css\como-agregar-librerias.css" />
    <!-- Js file -->
    <script src="../Js/prueba.js" defer></script>
    <script src="../Js/menu.js" defer></script>
    <script src="../Js/btn.js" defer></script>

    <!-- --------------------------------------------------------------------------------------------------------------- -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <!-- --------------------------------------------------------------------------------------------------------------- -->
  </head>
  
  <body>
    <style>
      p {
        margin: 0 !important;
      }
    </style>
    <!-- Top content -->
    <div class="top-content">
      <div class="icon-bar">
        <a class="microchip" href="../index.html">
          <i class="fas fa-microchip"></i>
        </a>
      </div>
      <label class="label"
        ><a href="../index.html">Microprocesadores UC</a></label
      >

      <div class="dropdow newDp inDevice">
        <a class="darkTheme" style="cursor: pointer"
          ><i class="fas fa-adjust" style="color: white"></i
        ></a>
      </div>

      <ul>
        <!-- Seccion de la teoria-->
        <div class="dropdow">
          <li class="dropbt"><a href="#">Teoria</a></li>

          <div class="dropdow-content">
            <div class="dropdow-content1">
              <a href="#" class="tema1"
                >Tema 1</i
              ></a>
              <ul>
                <a
                  href="#"
                  style="
                    border-bottom: 1px solid rgba(85, 85, 85, 0.014);
                    text-align: center;
                    background-color: #b5dfed;
                  "
                  >Sistemas microprogramables</a
                >
                <a href="Dispositivos-digitales-microprogramables.html">Microcontroladores/Microprocesadores</a>
              </ul>
            </div>

            <div class="dropdow-content2">
              <a href="#">Tema 2</a>

              <ul>
                <a
                  href="#"
                  style="
                    border-bottom: 1px solid rgba(85, 85, 85, 0.014);
                    text-align: center;
                    background-color: #b5dfed;
                  "
                  >Arquitectura de un sistema microprogramable</a
                >
                <a href="ATmega328P.html" >Arquitectura y Caracteristicas</a>
              </ul>
            </div>

            <div class="dropdow-content3">
              <a href="#">Tema 3</a>

              <ul>
                <a
                  href="#"
                  style="
                    border-bottom: 1px solid rgba(85, 85, 85, 0.014);
                    text-align: center;
                    background-color: #b5dfed;
                  "
                  >Temporizaciones e interrupciones</a
                >
                <a href="Timer-0.html">Timer 0</a>
                <a href="Timer-1.html">Timer 1</a>
                <a href="Timer-2.html">Timer 2</a>
                <a href="Manejo-de-interrupciones.html"
                  >Manejo de interrupciones</a
                >
                <a href="Modulación-por-ancho-de-pulso.html"
                  >Modulación por ancho de pulso <i>PWM</i></a
                >
                <a href="Timer0-Modo-Fase-Correcta.html"
                  >PWM Timer0 Modo Fase Correcta</a
                >
                <a href="Timer0-Modo-Rapido.html">PWM Timer0 Modo Rapido</a>
                <a href="Timer1-Modo-Fase-Correcta.html"
                  >PWM Timer1 Modo Fase Correcta</a
                >
                <a href="Timer1-Modo-Rapido.html">PWM Timer1 Modo Rapido</a>
              </ul>
            </div>

            <div class="dropdow-content4">
              <a href="#">Tema 4</a>

              <ul>
                <a
                  href="#"
                  style="
                    border-bottom: 1px solid rgba(85, 85, 85, 0.014);
                    text-align: center;
                    background-color: #b5dfed;
                  "
                  >Conversión Digital/Analógica - Analógica/Digital</a
                >
                <a href="Convertidor-ADC.html">Convertidor ADC</a>
              </ul>
            </div>

            <div class="dropdow-content5">
              <a href="#">Tema 5</a>

              <ul>
                <a
                  href="#"
                  style="
                    border-bottom: 1px solid rgba(85, 85, 85, 0.014);
                    text-align: center;
                    background-color: #b5dfed;
                  "
                  >Comunicación serial</a
                >
                <a href="USART.html">Comunicación Serial USART</a>
              </ul>
            </div>
          </div>
        </div>
        <!-- Seccion de laboratorio -->
        <div class="dropdow">
          <li class="dropbt"><a href="#">Laboratorio</a></li>

          <div class="dropdow-content">
                <a href="Instalacion-de-Proteus-8.5.html"
                  >Instalación de proteus 8.5</a
                >

                <a href="como-agregar-librerias-a-proteus-8.5.html"
                  >Como agregar librerias adicionales en Proteus 8.5</a
                >
                <a href="Descripcion-y-manejo.html"
                  >Descripcion y manejo de las librerias</a
                >
                <a href="IDE-Arduino.html">IDE software Arduino</a>
                <a href="IDE-AVR-Studio-7.html">IDE AVR Studio 7</a>
                <a href="Programar-Arduino-AVRStudio.html"
                  >Programar el Arduino con AVR Studio 7</a
                >
                <a href="introduccion-al-lenguaje-de-programacion-en-C.html"
                  >Introduccion al lenguaje de programacion en C</a
                >
                <a href="manejo-del-display-7seg.html"
                  >Manejo del display 7 Segmentos</a
                >
                <a href="Manejo-de-la-pantalla-LCD.html"
                  >Manejo de la pantalla LCD</a
                >
              
          </div>
        </div>
        <!-- Seccion de descarga -->
        <div class="dropdow">
          <li class="dropbt"><a href="#">Descargas</a></li>
          <div class="dropdow-content" >
            <a
              href="https://mega.nz/folder/PJBnTSaB#Sb-LwH7cwkHzQJKevcpG1g"
              target="_blank"
              >Descargar archivos en pdf</a
            >
            <a
              href="https://mega.nz/folder/fE5AAQhY#IVL100RFiLY0-649gnbLAw"
              target="_blank"
              >Practicas del Laboratorio</a
            >
          </div>
        </div>
        <!---->
        <div class="dropdow newDp">
          <li>
            <a class="darkTheme" style="cursor: pointer"
              ><i class="fas fa-adjust" style="color: white"></i
            ></a>
          </li>
          <div class="dropdow-content"></div>
        </div>
      </ul>
    </div>

    <!-- Haburguer menu -->
    <div id="nav-icon2">
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </div>

    <!-- Menu in devices -->

    <div class="content-device">
      <ul>
        <div class="dropdow">
          <li class="dropbt" onclick="myFunction()">Teoria</li>

          <div class="dropdow-content device">
            <a href="#" class="tema0 tema"
              >Tema 1: Sistemas microprogramables</a
            >

            <div class="subContent" style="margin-left: 2%; ">
              <a style="padding-right: 0;"
                class="before"
                href="Dispositivos-digitales-microprogramables.html"
                >Microcontroladores/Microprocesadores</a
              >
            </div>

            <a class="tema1 tema" href="#"
              >Tema 2: Arquitectura de un sistema microprogramable</a
            >

            <div class="subContent" style="margin-left: 5%">
              <a class="before" href="ATmega328P.html"
                >Arquitectura y Caracteristicas</a
              >
            </div>

            <a class="tema2 tema" href="#"
              >Tema 3: Temporizaciones e interrupciones</a
            >

            <div class="subContent" style="margin-left: 5%">
              <a class="before" href="Timer-0.html">Timer 0</a>
              <a class="before" href="Timer-1.html">Timer 1</a>
              <a class="before" href="Timer-2.html">Timer 2</a>
              <a class="before" href="Manejo-de-interrupciones.html"
                >Manejo de interrupciones</a
              >
              <a class="before" href="Modulación-por-ancho-de-pulso.html"
                >Modulación por ancho de pulso <i>PWM</i></a
              >
              <a class="before" href="Timer0-Modo-Fase-Correcta.html"
                >PWM Timer0 Modo Fase Correcta</a
              >
              <a class="before" href="Timer0-Modo-Rapido.html"
                >PWM Timer0 Modo Rapido</a
              >
              <a class="before" href="Timer1-Modo-Fase-Correcta.html"
                >PWM Timer1 Modo Fase Correcta</a
              >
              <a class="before" href="Timer1-Modo-Rapido.html"
                >PWM Timer1 Modo Rapido</a
              >
            </div>

            <a class="tema3 tema" href="#"
              >Tema 4: Conversión Digital/Analógica - Analógica/Digital</a
            >

            <div class="subContent" style="margin-left: 5%">
              <a class="before" href="Convertidor-ADC.html">Convertidor ADC</a>
            </div>

            <a class="tema4 tema" href="#">Tema 5: Comunicación serial </a>

            <div class="subContent" style="margin-left: 5%">
              <a class="before" href="USART.html">Comunicación Serial USART</a>
            </div>
          </div>
        </div>
        <div class="dropdow">
          <li class="dropbt" onclick="myFunction2()">Laboratorio</li>

          <div class="dropdow-content device2">
            <!---->
            <a class="tema5 tema" href="#">Primeros pasos</a>
            <div class="subContent" style="margin-left: 5%">
              <a class="before" href="Instalacion-de-Proteus-8.5.html"
                >Instalación de proteus 8.5</a
              >
              <a class="before" href="como-agregar-librerias-a-proteus-8.5.html"
                >Como agregar librerias adicionales en Proteus 8.5</a
              >
              <a class="before" href="Descripcion-y-manejo.html"
                >Descripcion y manejo de las librerias</a
              >
              <a class="before" href="Descripcion-y-manejo.html"
                >IDE software Arduino</a
              >
              <a class="before" href="IDE-AVR-Studio-7.html"
                >IDE AVR Studio 7</a
              >
              <a style="padding-right: 0;" class="before" href="Programar-Arduino-AVRStudio.html"
                >Programar el Arduino con AVR Studio 7</a
              >
              <a
                class="before"
                href="introduccion-al-lenguaje-de-programacion-en-C.html"
                >Introduccion al lenguaje de programacion en C</a
              >
              <a class="before" href="manejo-del-display-7seg.html"
                >Manejo del display 7 Segmentos</a
              >
              <a class="before" href="Manejo-de-la-pantalla-LCD.html"
                >Manejo de la pantalla LCD</a
              >
            </div>

            <a href="practica1.html">Práctica 1</a>
            <a href="practica2.html">Práctica 2</a>
            <a href="practica3.html">Práctica 3</a>
            <a href="practica4.html">Práctica 4</a>
            <a href="practica5.html">Práctica 5</a>

            <!---->
          </div>
        </div>
        <div class="dropdow">
          <li class="dropbt" onclick="myFunction3()">Descargas</li>
          <div class="dropdow-content device3">
            <a
              href="https://mega.nz/folder/PJBnTSaB#Sb-LwH7cwkHzQJKevcpG1g"
              target="_blank"
              >Descargar archivos en pdf</a
            >
            <a
              href="https://mega.nz/folder/fE5AAQhY#IVL100RFiLY0-649gnbLAw"
              target="_blank"
              >Practicas del Laboratorio</a
            >
          </div>
        </div>
      </ul>
    </div>

    <!-- sidenav content -->
    <div class="sidenav2">
      <label
        ><a href="#" style="color: black">Manejo de interrupciones</a></label
      >
      <ul>
        <li>
          <a href="#Que-es-una-interrupción">¿Que es una interrupción?</a>
        </li>
        <li>
          <a href="#Que-puede-causar-una-interrupción"
            >¿Que puede causar una interrupción?</a
          >
        </li>
        <li>
          <a href="#Interrupciones-en-el-ATmega328P"
            >Interrupciones en el ATmega328P</a
          >
        </li>
        <li>
          <a href="#ISR"
            >Como definir una ISR (rutina de servicio de interrupción)</a
          >
        </li>
        <li>
          <a href="#Habilitando-las-interrupciones"
            >Habilitando las interrupciones</a
          >
        </li>
        <li>
          <a href="#Cosas-que-se-necesitan-saber"
            >Cosas que se necesitan saber al trabajar con interrupciones</a
          >
        </li>
        <li>
          <a href="#Ejemplo-de-interrupción-externa-INT0"
            >Ejemplo de interrupción externa: INT0</a
          >
        </li>
        <li>
          <a href="#Ejemplo-de-interrupción-por-desbordamiento-del-timer0"
            >Ejemplo de interrupción por desbordamiento del timer0</a
          >
        </li>
      </ul>
    </div>

    <!-- content -->
    <div class="content">
      <!--title content -->
      <div class="h1-content  container" style="align-items: center;">
        <!-- Columna 1 -->
         <div class="col your-item2 desktopCol" style="width: 30%;">
           <img
                 src="../Imagenes/Facultad-de-ingenieria.png"
                 class="logo-footer"
                 style="display: block; margin: 15px auto; width: 85%;"
               />
               
         </div>
          <!-- Col 1 in Devices -->
         <div class="col deviceCol">
           <div class="container" style="flex-direction: row !important;">
             <div class="col your-item2">
               <img
                 src="../Imagenes/Facultad-de-ingenieria.png"
                 class="logo-footer"
                 style="display: block; margin: 15px auto; width: 70%;"
               />
             </div>
             <div class="col">
               <img
                 src="../Imagenes/ING_ELECT.jpg"
                 class="logo-footer"
                 style="display: block; margin: 15px auto; width: 50%;"
               />
             </div>
           </div>
         </div>
         <!-- Col 2 in Devices -->
         <div class="col deviceCol">
           <div style="font-family: 'Roboto', sans-serif; margin: 10px;">
             <p class="styleFooter" style="font-size: 12px !important;">Universidad de Carabobo</p>
             <p class="styleFooter" style="font-size: 12px !important;">Facultad de Ingeniería</p>
             <p class="styleFooter" style="font-size: 12px !important;">Escuela de Ingenieria Eléctrica</p>
             <p id="TTO" class="styleFooter" style="font-size: 12px !important;">Dpto. de Sistemas y Automática</p>
             
         </div>
         </div>
 
 
         <!-- Columna 2 -->
         <div class="col your-item2">
           <div class="desktopCol" style="font-family: 'Roboto', sans-serif; margin: 10px;">
             <p class="styleFooter" style="font-size: 12px !important;">Universidad de Carabobo</p>
             <p class="styleFooter" style="font-size: 12px !important;">Facultad de Ingeniería</p>
             <p class="styleFooter" style="font-size: 12px !important;">Escuela de Ingenieria Eléctrica</p>
             <p id="TTO" class="styleFooter" style="font-size: 12px !important;">Dpto. de Sistemas y Automática</p>
             
         </div>
           <div class="page-title">
             <h1 class="titleH7" style="font-size: 2em; margin-top: 15px; padding-top: 0;">
              Manejo de interrupciones
           </h1>
           </div>
           
         </div>
 
         <!-- Columna 3 -->
         <div class="col desktopCol" style="width: 30%;">
           <img
                 src="../Imagenes/ING_ELECT.jpg"
                 class="logo-footer"
                 style="display: block; margin: 15px auto; width: 65%;"
               />
         </div>
         
         
       </div>
      <!--main content -->
      <div class="main-content">
        <!-- -------------------------------------------------------------------------------------- -->
        <h3 class="jump" id="Que-es-una-interrupción">
          ¿Que es una interrupción?
        </h3>

        <p>
          Una interrupción es una forma en que un evento externo (o, a veces,
          interno) pause la actividad actual del procesador, de modo que pueda
          completar una breve tarea antes de reanudar la ejecución donde había
          quedado con anterioridad (antes de ser interrumpido)
        </p>
        <img class="resp1"
          style="padding: 10px 0; width: 40%"
          src="..\Imagenes\interrupts\interrupt.jpg"
          alt="interrupts flow"
        />

        <p>
          Digamos que estamos en casa, escribiendo un tutorial sobre como
          funcionan los procesadores. Estamos muy interesados en este tema, por
          lo que estamos dedicando toda nuestra concentración a nuestro teclado.
          Sin embargo, a mitad de camino, suena el teléfono. A pesar de no estar
          esperando una llamada por teléfono, podemos detener lo que estamos
          haciendo, atender la llamada y volver a donde quedamos una vez que
          hemos colgado
        </p>
        <p style="padding-top: 0">
          Así es como funciona una interrupción.
          <b
            >Podemos configurar el procesador para que esté buscando un evento
            especifico</b
          >
          (como un pin que cambia de estado o un temporizador desbordado) Cuando
          ocurren estos eventos, detenemos la tarea actual, manejamos el evento,
          y reanudamos donde lo habíamos dejado. Esto nos da flexibilidad, ya
          que, en lugar de tener que sondear activamente nuestros eventos para
          saber si van a suceder (polling), podemos ignorarlos por completo y
          confiar en nuestra rutina de interrupción para luego procesarlos
          cuando estos ocurran
        </p>

        <p>
          Lo que estamos haciendo se llama procesamiento asíncrono, es decir,
          estamos procesando los eventos de interrupción fuera del “hilo de
          ejecución” regular del programa principal.
        </p>
        <p style="padding-top: 0">
          Cabe destacar que no se están haciendo dos cosas a la vez (aunque
          pueda parecer así): el programa normal se detiene mientras se ejecuta
          una rutina de interrupción. Cuando se configura correctamente, podemos
          vincular una fuente de interrupción especifica a una ruina del
          controlador especifica, esta es llamada
          <b>Rutina de Servicio de Interrupción</b> o <b>ISR</b> por sus siglas
          en ingles (<b>Interrupt Service Routine</b>)
        </p>

        <!-- -------------------------------------------------------------------------------------- -->
        <h3
          class="jump"
          id="Que-puede-causar-una-interrupción"
          style="margin-top: 2%"
        >
          ¿Que puede causar una interrupción?
        </h3>
        <p>Hay dos fuentes principales de interrupción:</p>
        <ul>
          <li style="padding: 5px 0">
            <b>Interrupciones de Hardware</b>: ocurren en respuesta a un evento
            externo cambiante, como un cambio en el estado de un pin o un
            temporizador que alcanza un valor preestablecido
          </li>
          <li style="padding: 5px 0">
            <b>Interrupciones de Software</b>: ocurren en respuesta a un comando
            emitido en software
          </li>
        </ul>

        <p>
          Cada modelo AVR contiene un conjunto diferente de fuentes de
          interrupción. Podríamos averiguar que tipo de interrupciones tiene
          nuestro modelo elegido buscando en el capitulo “<b>Interrupciones</b>”
          en la hoja de datos del AVR especificado (Datasheet)
        </p>

        <!-- -------------------------------------------------------------------------------------- -->
        <h3
          class="jump"
          id="Interrupciones-en-el-ATmega328P"
          style="margin-top: 2%"
        >
          Interrupciones en el ATmega328P
        </h3>
        <p>
          Aquí se muestra la lista completa de todas las interrupciones posibles
          en el ATmega328P, dando la dirección de la tabla de vectores de cada
          interrupción, el nombre de la interrupción de origen y descripción de
          la fuente de interrupción
        </p>
        <img class="resp1"
          style="padding: 10px 0; width: 65%"
          src="..\Imagenes\interrupts\interrupt list.png"
          alt="interrupt list"
        />
        <p style="text-align: center; padding: 0;font-size: 13px;"><i>Fuente: Microcontrollers ATmega328P Datasheet</i></p>
        <!-- -------------------------------------------------------------------------------------- -->
        <h3 class="jump" id="ISR" style="margin-top: 2%">
          Como definir una ISR (rutina de servicio de interrupción)
        </h3>
        <p>
          Para que se invoque una rutina de interrupción (<b>ISR</b>)
          necesitaremos tres condiciones:
        </p>
        <ol>
          <li>
            <b
              >El bit de habilitación de interrupciones globales (I) del AVR
              debe ser activado</b
            >
            en el registro de control del MCU: <b>SREG</b>
          </li>
          <p>
            Esto permite que se procese una interrupción a través del ISR cuando
            se configura (Se establece el bit en 1) y evita que se ejecuten
            cuando se borra (cuando el bit este inicializado a cero). El valor
            predeterminado del bit es cero al encenderlo, por ende, debemos
            establecer la configuración
          </p>
          <img class="resp1"
            style="padding: 10px 0; width: 70%"
            src="..\Imagenes\interrupts\global interrupt.png"
            alt="global interrupt AVR"
          />
          <p style="text-align: center; padding: 10px 0;font-size: 13px;"><i>Fuente: Microcontrollers ATmega328P Datasheet</i></p>
          <li>
            <b
              >Se debe configurar el bit de habilitación de la fuente de
              interrupción individual (<b>IE - Interrupt Enable</b>)</b
            >
          </li>
          <p>
            Cada fuente de interrupción tiene un bit de habilitación de
            interrupción separado relacionado a los registros de control de
            periféricos, que activan el ISR para esa interrupción en especifico.
            Estos también hay que configurarlos (habilitarlos) de modo que,
            cuando ocurra el evento de interrupción el procesador ejecute el ISR
            asociado.
          </p>
          <p>
            <b>Ejemplo</b>: bit para habilitar interrupción por desbordamiento
            del timer/Counter0
          </p>
          <img class="resp1"
            style="padding: 10px 0; width: 70%"
            src="..\Imagenes\interrupts\interrupt timer0.png"
            alt="interrupt timer0 AVR"
          />
          <p style="text-align: center; padding: 10px 0;font-size: 13px;"><i>Fuente: Microcontrollers ATmega328P Datasheet</i></p>
          <li><b>La condición de interrupción debe cumplirse</b></li>
          <p>
            Considerando el ejemplo de la interrupción por desbordamiento del
            timer0 para que se ejecute la <b>ISR</b> se debe cumplir la
            condición de desbordamiento, es decir, dado que el timer0 es un
            registro de 8 bits el desbordamiento ocurrirá cuando este alcance el
            máximo valor y luego se inicialice a cero (es decir, cuando vaya de
            255 y vuelva a 0) es en este momento donde ocurre la rutina de
            interrupción
          </p>
        </ol>
        <div class="note">
          <p style="padding: 5px">
            Cuando se cumplen las tres condiciones, el AVR activará nuestra ISR
            cada vez que ocurra el evento de interrupción.
          </p>
        </div>

        <h5 style="margin-top: 3%">Estructura en C</h5>
        <div class="code_panel">
          <code> 
            <span class="define_include">#include</span> <span class="originalAVR">&lt;avr/interrupt.h&gt;</span></br><br>
            <span class="variables">ISR</span> <span class="originalAVR">((<span style="color: red;">vector fuente</span>)_</span><span class="variables">vect</span><span class="originalAVR">)</span> </br>
            <span class="originalAVR">{</span><br>
            <span style="margin-left: 1.5vw;" class="code_comment">// Codigo que se ejecuta en la ISR</span><br>
            <span class="originalAVR">}</span><br>
          </code>
        </div>

        <h5 style="margin-top: 3%">Estructura en Assembler</h5>
        <div class="code_panel">
          <code> 
            <span class="originalAVR">.ORG 0x(<span style="color: red;">direccion del vector</span>)</span><br>
            <span class="define_include">jmp </span> <span class="originalAVR">MyISR</span></br><br>
            <span class="originalAVR">MyISR:</span><br>
            <span style="margin-left: 1.5vw;" class="code_comment">; Codigo que se ejecuta en la ISR</span><br>
            <span class="define_include">reti</span>
          </code>
        </div>

        <div style="margin-top: 3%;" class="note">
          <p style="padding: 5px;">Por defecto, las interrupciones no son interrumpibles. Cuando se “dispara” una interrupción el AVR automáticamente deshabilita el bit de interrupciones globales (<b>I = 0</b>) para evitar que la ISR que se esta ejecutando sea interrumpida. Esto es precisamente para evitar que el Stack se desborde por demasiadas interrupciones ocurriendo al mismo tiempo, así como también, evitar que las ISR se ejecuten durante demasiado tiempo.<br>
            Una vez finalizada la interrupción que se disparó, el bit de interrupciones globales automáticamente se reestablece (<b>I = 1</b>) para dar paso a que se ejecute otra nueva interrupción
          </p>
        </div>

        <!-- -------------------------------------------------------------------------------------- -->
        <h3 class="jump" id="Habilitando-las-interrupciones" style="margin-top: 2%">
          Habilitando las interrupciones
        </h3>

        <p>Si simplemente se agrega una ISR a un programa ya existente, nos podemos encontrar con el hecho de que, al intentar ejecutar la ISR este no lo hace. Esto es porque mientras nosotros hemos definido una ISR no hemos habilitado la fuente de interrupción, como se menciono antes, se deben de cumplir tres criterios para que se active la ISR</p>
        <p style="padding-top: 0;">En primer lugar necesitamos activar el bit de interrupciones globales (I) del registro SREG. Sin este bit activado se ignoraran todas y cada una de las interrupciones en el programa.
        </p>
        <p style="padding-top: 0;">Podemos usar (En lenguaje C) dos macros especiales  definidos en la librería que se debe establecer de cabecera: <br>
           <i><a style="font-family: 'Bitter', serif"><span style="color: blue">#include</span> &lt;avr/interrupt.h&gt;
        </a></i> los cuales son:</p>
        <ul>
          <li><span style="color: blue;">Sei</span>(): habilita el bit I del registro SREG (Set I)</li>
          <li><span style="color: blue;">Cli</span>(): Deshabilita el bit I del registro SREG (Clear I)</li>
        </ul>
        <div class="code_panel">
          <code> 
            <span class="functionsDeclarations">Sei</span><span class="originalAVR">(); </span><span class="code_comment">// coloca en 1 el bit de interrupciones globales</span> <br>
          </code>
        </div>

        <style>
          ::-webkit-scrollbar {
            display: none;
          }
        </style>

        <p><b>Lo siguiente será habilitar la fuente de interrupción especifica</b>, para así satisfacer  la segunda condición anteriormente mencionada</p>
        <p>Seguiremos pues, con el mismo ejemplo de la interrupción producida por el desbordamiento del <b>timer0</b></p>
        <div class="code_panel">
          <code> 
            <span class="variables">TIMSK0</span><span class="originalAVR"> |= (1 << </span> <span class="variables">TOIE0</span><span class="originalAVR">);</span>  <span class="code_comment">// interrupcion por desbordamiento del Timer/Counter0 habilitada</span> <br>
          </code>
        </div>

        <p>Esto debería ser suficiente para hacer que la ejecución del AVR salte al ISR apropiado cuando ocurra la interrupción</p>
        <!-- -------------------------------------------------------------------------------------- -->
        <h3 class="jump" id="Cosas-que-se-necesitan-saber" style="margin-top: 2%">
          Cosas que se necesitan saber al trabajar con interrupciones
        </h3>
        <ol>
          <li>
            Cuando se esta ejecutando una interrupción, el programa principal no lo esta. Esto significa que si la aplicación no es lo suficientemente solida y recibe muchas interrupciones en muy poco tiempo, la ejecución del programa principal se detendrá
          </li>
          <li>
           <b>Los datos compartidos entre la ISR y el programa principal deben ser volátiles</b> y de alcance global en el lenguaje C. Sin la palabra clave volátil, el compilador puede optimizar los accesos a una variable que se actualice en la ISR, ya que el lenguaje C no tiene un concepto de ejecución con diferentes “hilos”.
          </li>
          <li>
            Veamos el siguiente ejemplo:
          </li>
          <div class="code_panel">
            <code> 
              <span class="define_include">#include</span> <span class="originalAVR">&lt;avr/io.h&gt;</span></br>
              <span class="define_include">#include</span> <span class="originalAVR">&lt;avr/interrupt.h&gt;</span></br><br>
              
              <span class="define_include">int</span> <span class="originalAVR"> MyVar;</span> <span class="code_comment">// Variable declarada tipo int</span></br><br>
          
              <span class="variables">ISR</span> <span class="originalAVR">((<span style="color: red;">vector fuente</span>)_</span><span class="variables">vect</span><span class="originalAVR">)</span> </br>
              <span class="originalAVR">{</span><br>
              <span style="margin-left: 1.5vw;" class="originalAVR">MyVar++;</span> <span class="code_comment">//incremento de una unidad a la variable Myvar</span><br>
              <span class="originalAVR">}</span><br><br>

              <span class="define_include">int</span> <span class="functionsDeclarations">main</span><span class="originalAVR">(</span><span class="define_include">void</span><span class="originalAVR">)</span> <span class="originalAVR">{</span></br>
              <span class="functionsDeclarations">Conf_Interrupt</span><span class="originalAVR">();</span> <span class="code_comment">//funcion declarada en el programa</span><br>
              <span class="define_include" >while</span> <span class="originalAVR">(MyVar == 0);</span> <span class="code_comment">// espera por la interrupcion</span></br>
              <span class="functionsDeclarations">Enciende_el_LED</span><span class="originalAVR">();</span> <span class="code_comment">//funcion declarada en el programa</span><br>
              <span class="originalAVR">}</span><br>
            </code>
          </div>

          <div class="note" style="margin-top: 2%;">
            <p style="padding: 5px;">Hay una buena posibilidad de que el programa se congele para siempre en el ciclo while, ya que (según el optimizador) el valor global de “MyVar” nunca cambiará en el bucle.
              Al hacer que la variable global sea volátil se le esta diciendo al compilador que el valor puede cambiar debido a circunstancias desconocidas, obligándolo a generar código para recargar el valor cada vez</p>
          </div>

          <li style="margin-top: 2%;">
            Cada fuente de interrupción tiene exactamente una bandera para indicar que ocurrió el evento. Si dos de estas interrupciones ocurren mientras se esta en medio de la ejecución de una ISR  solo se atenderá la otra interrupción cuando finalice la ISR actual. Esto significa que si existen muchas interrupciones que ocurren en un corto espacio de tiempo, se pueden perder interrupciones antes de que exista la posibilidad de procesarlos.
          </li>

        </ol>

        <!-- -------------------------------------------------------------------------------------- -->
        <h3 class="jump" id="Ejemplo-de-interrupción-externa-INT0" style="margin-top: 2%">
          Ejemplo de interrupción externa: INT0
        </h3>

        <p>En este ejemplo se ilustra el manejo de una interrupción externa, este se encarga de cambiar el estado de los bits del puerto B en cada flanco de bajada producida en el pin INT0</p>

        <div class="code_panel">
          <div id="button1" onclick="CopyToClipboard('code_panel7')"><i class="far fa-copy"></i> copiar código</div>
          <code id="code_panel7">
            <span class="define_include">#define</span> <span class="variables">F_CPU</span> <span class="originalAVR">16000000UL</span> <span class="code_comment">// Frecuencia de trabajo del microcontrolador</span></br>
            <span class="define_include">#include</span> <span class="originalAVR">&lt;avr/io.h&gt;</span></br>
            <span class="define_include">#include</span> <span class="originalAVR">&lt;util/delay.h&gt;</span></br>
            <span class="define_include">#include</span> <span class="originalAVR">&lt;avr/interrupt.h&gt;</span></br><br>
            <span class="code_comment">/************** Rutina de Interrupcion **********************/</span></br>
            <span class="variables">ISR</span> <span class="originalAVR">(INT0_vect<span class="originalAVR">)</span> </br>
            <span class="originalAVR">{</span><br>
            <span style="margin-left: 1.5vw;" class="variables">PORTB</span>  <span class="originalAVR">= ~(</span><span class="variables">PORTB</span><span class="originalAVR">);</span> <span class="code_comment">// invierte el estado de los bits del puertoB</span><br>
            <span style="margin-left: 1.5vw;"><span class="functionsDeclarations">_delay_ms</span><span class="originalAVR">(100);</span></span>  </br>
            <span class="originalAVR">}</span><br><br>
            
            
            <span class="code_comment">/************** Programa principal **********************/</span></br>
            <span class="define_include">int</span> <span class="functionsDeclarations">main</span><span class="originalAVR">(</span><span class="define_include">void</span><span class="originalAVR">)</span> <span class="originalAVR">{</span></br>
              <span style="margin-left: 1.5vw;"><span class="variables">DDRB</span> <span class="originalAVR">= 0xFF;</span></span> <span class="code_comment">// Puerto B como salida</span></br>
              <span style="margin-left: 1.5vw;"><span class="variables">PORTB</span> <span class="originalAVR">= 0;</span></span> </br>
              <span style="margin-left: 1.5vw;"><span class="variables">EIMSK</span> <span class="originalAVR">= (1 &lt;&lt;</span> <span class="variables">INT0</span><span class="originalAVR">);</span> </span> <span class="code_comment">// interrupcion por INT0 activada</span></br>
              <span style="margin-left: 1.5vw;"><span class="variables">EICRA</span> <span class="originalAVR">= (1 &lt;&lt;</span> <span class="variables">ISC01</span><span class="originalAVR">) | ~(1 &lt;&lt;</span> <span class="variables">ISC00</span><span class="originalAVR">);</span> <span class="code_comment">//Interrupcion por flanco de bajada</span></br>
              <span style="margin-left: 1.5vw;" class="functionsDeclarations">sei</span><span class="originalAVR">(); </span><span class="code_comment">// coloca en 1 el bit de interrupciones globales</span> <br>
              <span class="define_include" style="margin-left: 1.5vw;">while</span> <span class="originalAVR">(1) {}</span> <span class="code_comment">// Ciclo infinito, todo ocurre en la ISR</span></br>
          
            <span class="originalAVR">}</span></br>
            </code>
        </div>

        <h4 style="margin-top: 2%;">En proteus:</h4>
        <img class="resp1"
          style="padding: 10px 0; width: 40%"
          src="..\Imagenes\interrupts\int INT0.png"
          alt="interrupts with AVR INT0"
        />
        <p style="text-align: center; padding: 0;font-size: 13px;"><i>Fuente: Elaboración propia</i></p>
        <!-- -------------------------------------------------------------------------------------- -->
        <h3 class="jump" id="Ejemplo-de-interrupción-por-desbordamiento-del-timer0" style="margin-top: 2%">
          Ejemplo de interrupción por desbordamiento del timer0
        </h3>

        <p>En este ejemplo se ilustra la utilización de la interrupción por desbordamiento del timer0 encendiendo y apagando un LED conectado al pin 6 del PuertoD</p>
        
        <div class="code_panel">
          <div id="button1" onclick="CopyToClipboard('code_panel6')"><i class="far fa-copy"></i> copiar código</div>
          <code id="code_panel6">
            <span class="define_include">#define</span> <span class="variables">F_CPU</span> <span class="originalAVR">16000000UL</span> <span class="code_comment">// Frecuencia de trabajo del microcontrolador</span></br>
            <span class="define_include">#include</span> <span class="originalAVR">&lt;avr/io.h&gt;</span></br>
            <span class="define_include">#include</span> <span class="originalAVR">&lt;util/delay.h&gt;</span></br>
            <span class="define_include">#include</span> <span class="originalAVR">&lt;avr/interrupt.h&gt;</span></br><br>

            <span class="define_include">volatile uint8_t</span> <span class="originalAVR">Count;</span> <span class="code_comment">// variable volatil de 8 bits</span> <br><br>


            <span class="code_comment">/************** Rutina de Interrupcion **********************/</span></br>
            <span class="variables">ISR</span> <span class="originalAVR">(TIMER0_OVF_vect)</span> </br>
            <span class="originalAVR">{</span><br>
            <span style="margin-left: 1.5vw;" class="define_include">if</span>  <span class="originalAVR">(Count == 60) {</span> <span class="code_comment">// Retardo de 1 segundo</span><br>
            <span style="margin-left: 1.5vw;"><span class="variables">PORTD</span> <span class="originalAVR">^= (1 &lt;&lt; 6);</span></span>  <span class="code_comment">//invierte el bit 6 del puerto D</span></br>
            <span style="margin-left: 1.5vw;"><span class="originalAVR">Count = 0;</span> </br>
            <span style="margin-left: 1.5vw;" class="originalAVR">}</span><br>
            <span style="margin-left: 1.5vw;" class="define_include">else</span>  <span class="originalAVR">{</span><br>
            <span style="margin-left: 1.5vw;"><span class="originalAVR">Count++;</span> </br>
            <span style="margin-left: 1.5vw;" class="originalAVR">}</span><br>
            <span class="originalAVR">}</span><br><br>

            <span class="code_comment">/************** Programa principal **********************/</span></br>
            <span class="define_include">int</span> <span class="functionsDeclarations">main</span><span class="originalAVR">(</span><span class="define_include">void</span><span class="originalAVR">)</span> <span class="originalAVR">{</span></br>
              <span style="margin-left: 1.5vw;"><span class="variables">DDRD</span> <span class="originalAVR">|= (1 &lt;&lt; 6);</span> <span class="code_comment">// PD6 como salida</span> </br>
              <span style="margin-left: 1.5vw;"><span class="variables">TCNT0</span> <span class="originalAVR">= 0;</span> <span class="code_comment">// Registro contador inicializado a cero</span></span> </br>
              <span style="margin-left: 1.5vw;"><span class="originalAVR">Count = 0;</span> </br>
              <span style="margin-left: 1.5vw;"><span class="variables">TCCR0B</span> <span class="originalAVR">= (1 &lt;&lt;</span> <span class="variables">CS00</span><span class="originalAVR">)|(1 &lt;&lt;</span> <span class="variables">CS02</span><span class="originalAVR">);</span> <span class="code_comment"> // reloj interno con Preescalador 1024 (clk/1024 (from prescaler))</span></span> </br>
              <span style="margin-left: 1.5vw;"><span class="variables">TIMSK0</span> <span class="originalAVR"> = (1 &lt;&lt;</span> <span class="variables">TOIE0</span><span class="originalAVR">);</span> <span class="code_comment"> // interrupcion por desvordamiento del Timer/Counter0 habilitada</span></span> </br>
              <span style="margin-left: 1.5vw;"><span class="functionsDeclarations">sei</span><span class="originalAVR">(); </span> <span class="code_comment">  // habilita interrupciones globales</span></span> </br>
              <span class="define_include" style="margin-left: 1.5vw;">while</span> <span class="originalAVR">(1) {}</span> <span class="code_comment">// Ciclo infinito, todo ocurre en la ISR</span></br>
          
            <span class="originalAVR">}</span></br>
            </code>
        </div>
        <h4 style="margin-top: 3%;"> 
          En proteus:
        </h4>
        <img class="resp1"
          style="padding: 10px 0; width: 40%"
          src="..\Imagenes\interrupts\led timer0.gif"
          alt="interrupt Timer0 AVR"
        />
        <p style="text-align: center; padding: 0;font-size: 13px;"><i>Fuente: Elaboración propia</i></p>

        
        <!-- -------------------------------------------------------------------------------------- -->
        <div
          style="
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(0, 0, 0, 0.125);
            border-radius: 0.25rem;
            margin-top: 20px;
          "
        >
          <div
            class="card"
            style="
              cursor: pointer;
              transition: 0.3s;
              padding: 0.5rem 1rem;
              background-color: rgba(0, 0, 0, 0.03);
              border-bottom: 1px solid rgba(0, 0, 0, 0.125);
            "
          >
            <h2 style="margin: 0">
              <a
                class="ref"
                style="
                  margin: 0;
                  text-decoration: none;
                  color: black;
                  transition: 0.3s;
                "
                >Referencias</a
              >
            </h2>
          </div>
          <div class="collapse" style="transition: height 200ms">
            <div style="flex: 1 1 auto; padding: 1rem 1rem">
              <ol class="list">
                <li>
                  8-bit AVR Microcontroller with 32K Bytes In-System
                  Programmable Flash.
                  <a
                    style="text-decoration: none"
                    href="https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-7810-Automotive-Microcontrollers-ATmega328P_Datasheet.pdf"
                    >DataSheet</a
                  >.
                </li>
                <li>
                  AVR® Interrupts. (s.f). Recuperado de: <a style="text-decoration: none;" href="https://microchipdeveloper.com/8avr:int">https://microchipdeveloper.com/8<br>avr:int</a>
                </li>

                <li>avr-libc. (s.f). Recuperado de: <a style="text-decoration: none;" href="https://www.nongnu.org/avr-libc/user-manual/group__avr__interrupts.html">https://www.nongnu.org/avr-libc/user-manual/group__avr__interrupts.html</a> </li>
                
              </ol>
            </div>
          </div>
        </div>
        <style>
          .collapse.vis {
            display: block;
            transition: 0.3s;
          }
          .collapse {
            display: none;
            transition: 0.3s ease-in-out;
          }
        </style>
      </div>


      <footer
          class="container-fluid bg-grey"
          style="padding-top: 0px; padding-left: 0"
        >
          <div class="container">
            <!--primera columna-->
            <div class="col">
              <div class="your-item">
                <img
                  src="../Imagenes/Facultad-de-ingenieria.png"
                  class="logo-footer"
                  style="display: block; margin: 15px auto"
                />
                <p class="styleFooter">Universidad de Carabobo</p>
                <p class="styleFooter">Facultad de Ingeniería</p>
                <p class="styleFooter">Escuela de Ingenieria Eléctrica</p>
                <p id="TTO" class="styleFooter">
                  Dpto. de Sistemas y Automática
                </p>
                <p class="styleFooter">© 2021</p>
              </div>
            </div>

            <!--segunda columna-->
            <div class="col">
              <h6
                id="brand"
                style="display: block; text-align: center; margin-bottom: 0"
              >
                Microprocesadores
              </h6>
              <h6
                style="display: block; text-align: center; margin-bottom: 20px"
              >
                SA7E04
              </h6>
              <p style="display: block; text-align: center">
                Prof: Whendy Garcia.
              </p>
              <a href="mailto: whendygarcia@gmail.com" class="btn-footer"
                >Enviar un correo</a
              ><br />
              <a
                href="https://www.arduino.cc/"
                class="btn-footer"
                target="_blank"
                >Ir a: Arduino - Home
              </a>
            </div>

            <!--tercera columna-->
            <div class="col">
              <h6 style="margin-top: 10%">Búsqueda</h6>
              <div class="social">
                <a
                  href="https://instagram.com/electricaing_uc?igshid=1grr9yjuz5rk3"
                  target="_blank"
                  title="Instagram"
                  ><i class="fab fa-instagram"></i
                ></a>
                <a
                  href="https://www.facebook.com/groups/35195859789/?ref=share"
                  target="_blank"
                  title="Facebook"
                  ><i class="fab fa-facebook-square"></i
                ></a>
                <a
                  href="https://twitter.com/electricaing_uc?s=20"
                  target="_blank"
                  title="Twitter"
                  ><i class="fab fa-twitter-square"></i
                ></a>
                <a
                  href="https://youtube.com/channel/UC-zreC_L2Uqd7vYe4GNi1Hw"
                  target="_blank"
                  title="YouTube"
                  ><i class="fab fa-youtube"></i
                ></a>
              </div>
              <form
                class="form-footer my-3"
                style="margin-bottom: 0 !important"
              >
                <input
                  type="text"
                  placeholder="search here...."
                  name="search"
                />
                <button id="go"><i class="fa fa-search"></i></button>
              </form>
              <p
                class="subTitle"
                style="
                  font-style: italic;
                  margin-bottom: 0;
                  padding-bottom: 0;
                  padding-top: 5%;
                "
              >
                Realizado por:
              </p>
              <p style="font-style: italic; padding: 0; margin-bottom: 0">
                Victor Ojeda, Gilberto Virguez
              </p>
            </div>

            
          </div>
        </footer>

      <!-- floating button <a href="mailto: vctrinox@gmail.com" class="float"><i class="fa fa-envelope my-float"></i></a>-->
      <div class="action" onclick="actionToggle()">
        <span>+</span>
        <ul
          style="
            font-family: 'Roboto', sans-serif;
            height: 100vw;
            overflow: auto;
          "
        >
          <li>
            <a href="#Que-es-una-interrupción">¿Que es una interrupción?</a>
          </li>
          <li>
            <a href="#Que-puede-causar-una-interrupción"
              >¿Que puede causar una interrupción?</a
            >
          </li>
          <li>
            <a href="#Interrupciones-en-el-ATmega328P"
              >Interrupciones en el ATmega328P</a
            >
          </li>
          <li>
            <a href="#ISR"
              >Como definir una ISR (rutina de servicio de interrupción)</a
            >
          </li>
          <li>
            <a href="#Habilitando-las-interrupciones"
              >Habilitando las interrupciones</a
            >
          </li>
          <li>
            <a href="#Cosas-que-se-necesitan-saber"
              >Cosas que se necesitan saber al trabajar con interrupciones</a
            >
          </li>
          <li>
            <a href="#Ejemplo-de-interrupción-externa-INT0"
              >Ejemplo de interrupción externa: INT0</a
            >
          </li>
          <li>
            <a href="#Ejemplo-de-interrupción-por-desbordamiento-del-timer0"
              >Ejemplo de interrupción por desbordamiento del timer0</a
            >
          </li>
        </ul>
      </div>
      <!-- End of floating button -->
    </div>
  </body>
</html>
